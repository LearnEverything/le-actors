<!DOCTYPE html><html lang="en" dir="ltr" data-app-version="0.4.0"><head><meta name="theme-color" content="#1976d2"/><link rel="stylesheet" data-href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&amp;display=swap"/><meta charSet="utf-8"/><title>Vulcan Next</title><meta name="viewport" content="minimum-scale=1, initial-scale=1, width=device-width"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#da532c"/><meta name="theme-color" content="#ffffff"/><meta name="next-head-count" content="10"/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.15878d4e523f86636251.js" as="script"/><link rel="preload" href="/_next/static/chunks/49d37b1fe5b22506c9fa44358877aa1ad4760387.84b9a2250f3507cbc246.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-0c1b2fbe949ce7ed0b37.js" as="script"/><link rel="preload" href="/_next/static/chunks/6814153d.55e79d0ace6a369535d5.js" as="script"/><link rel="preload" href="/_next/static/chunks/abdd1237.851fcaa2eb374e04eb6e.js" as="script"/><link rel="preload" href="/_next/static/chunks/2852872c.1e535e2a60c8b1bb652c.js" as="script"/><link rel="preload" href="/_next/static/chunks/a7b3c51d.52db8c35c087bd5201c4.js" as="script"/><link rel="preload" href="/_next/static/chunks/6bf3b88e.63754aeaeb9ea39b4450.js" as="script"/><link rel="preload" href="/_next/static/chunks/d8b556227082b089fba546fc49732c1c26dde9e8.3baab1ffc7e421b8ce40.js" as="script"/><link rel="preload" href="/_next/static/chunks/cacb2f4be546d82ccacbeceb90144647cfaf61b3.5e95e488b17f7061269a.js" as="script"/><link rel="preload" href="/_next/static/chunks/dc94815230cec2e3dc385c60b5c9915f62add97b.695396e86e0ec8897ecf.js" as="script"/><link rel="preload" href="/_next/static/chunks/a30cd3318b9b886b5d858ad51b134bd993cb5816.d27260bb935159bd6a45.js" as="script"/><link rel="preload" href="/_next/static/chunks/d4e47d1519710928b34951a0ea9d9cd193d92d49.9971bad6776f2ae33b1d.js" as="script"/><link rel="preload" href="/_next/static/chunks/3a70e6ca8bb90afb418f91901a1a2d79eca87d11.653c5ba70ff602495b97.js" as="script"/><link rel="preload" href="/_next/static/chunks/a0ff704ef108d8660daf8e32b79639862454ff27.2699fef4fca937f989ce.js" as="script"/><link rel="preload" href="/_next/static/chunks/b202358fbad7102d8f59ff97683d6692f5162b5a.ff60acf86fb391457c31.js" as="script"/><link rel="preload" href="/_next/static/chunks/065cc5f8365af490fbc175069f90cda4b12ce284.84c794ca58b26180faf5.js" as="script"/><link rel="preload" href="/_next/static/chunks/9e2eadce9af178671d966780d5efb249d032d4cb.d95f3055d0bd9b97b719.js" as="script"/><link rel="preload" href="/_next/static/chunks/73ac6b829710f5f1d659c5f8c66d8fd8a56cf37b.ba3cf88997dfb8224aaf.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-b8fa6429bc2f3fc3e6f0.js" as="script"/><link rel="preload" href="/_next/static/chunks/020c44199048e84d10f9273012ae0db0d8fa4bac.993dcc6fba2c95c40340.js" as="script"/><link rel="preload" href="/_next/static/chunks/e06310d82fadbc2be302e5a8f1a04fa265a72c52.302fd6ae58f1dc2acb02.js" as="script"/><link rel="preload" href="/_next/static/chunks/44092f8551b68c748985c7de7a4b45e7cfc73eb0.5eb7c3e485d7c226cd16.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/docs/%5B%5B...filePath%5D%5D-ffb2f77215366165b9d3.js" as="script"/><style id="__jsx-1524775221">.MDXProvider.root.jsx-1524775221{margin:32px auto;max-width:1000px;}</style><style id="__jsx-376217870">nav.jsx-376217870{max-width:42rem;margin:0 auto;padding:0.2rem 1.25rem;max-width:1000px;margin:auto;}ul.jsx-376217870{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;list-style:none;margin-left:0;padding-left:0;}li.jsx-376217870{margin-right:1rem;}li.jsx-376217870:first-child{margin-left:auto;}a.jsx-376217870{color:violet;-webkit-text-decoration:none;text-decoration:none;}footer.jsx-376217870{color:#000;border-top:1px solid;border-image-source:linear-gradient(10deg,#e1009855,#3f77fa55);border-image-slice:1;border-color:#3f77fa;}</style><style id="__jsx-446662607">.global body{font-size:16px;}.global h1,.global .MuiTypography-h1{font-size:3.815em;}.global h2,.global .MuiTypography-h2{font-size:2.45em;}.global h3,.global .MuiTypography-h3{font-size:1.5em;}.global h4,.global .MuiTypography-h4{font-size:1.3em;}.global h5,.global .MuiTypography-h5{font-size:1.2em;}.global p,.global .MuiTypography-body1,.global .MuiTypography-body2{font-size:1em;}.global .helper,.global .MuiTypography-caption{font-size:0.8em;}.global .legal{font-size:0.7em;}.global p,.global p.MuiTypography-root{margin-bottom:0.6em;}.global h1,.global h3,.global h4,.global h5,.global h6{margin-top:32px;margin-bottom:16px;}.global h2{margin-top:48px;margin-bottom:16px;}</style><style id="jss-server-side"></style><style data-href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmSU5fBBc-.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOmCnqEu92Fr1Mu4mxM.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmEU9fBBc-.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmWUlfBBc-.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmSU5fCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmSU5fABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmSU5fCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmSU5fBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmSU5fCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmSU5fChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmSU5fBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOmCnqEu92Fr1Mu72xKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOmCnqEu92Fr1Mu5mxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOmCnqEu92Fr1Mu7mxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOmCnqEu92Fr1Mu4WxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOmCnqEu92Fr1Mu7WxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOmCnqEu92Fr1Mu7GxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOmCnqEu92Fr1Mu4mxKKTU1Kg.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmEU9fCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmEU9fABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmEU9fCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmEU9fBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmEU9fCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmEU9fChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmEU9fBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmWUlfCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmWUlfABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmWUlfCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmWUlfBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmWUlfCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmWUlfChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v27/KFOlCnqEu92Fr1MmWUlfBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><div class="jsx-446662607 global"><main class="jsx-446662607"><div class="jsx-1524775221 MDXProvider root"><style data-emotion="css o2w69a-MuiTypography-root">.css-o2w69a-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:300;font-size:6rem;line-height:1.167;letter-spacing:-0.01562em;}</style><h1 class="MuiTypography-root MuiTypography-h1 css-o2w69a-MuiTypography-root"><style data-emotion="css 778kay-MuiLink-root">.css-778kay-MuiLink-root{-webkit-text-decoration:none;text-decoration:none;}.css-778kay-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><style data-emotion="css zr39bh-MuiTypography-root-MuiLink-root">.css-zr39bh-MuiTypography-root-MuiLink-root{margin:0;color:#1976d2;-webkit-text-decoration:none;text-decoration:none;}.css-zr39bh-MuiTypography-root-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-zr39bh-MuiTypography-root-MuiLink-root" href="/"><img src="/img/vns-logo-96.png" style="margin-right:32px"/></a>VN Live Documentation</h1><div style="max-width:1000px"><style data-emotion="css 778kay-MuiLink-root">.css-778kay-MuiLink-root{-webkit-text-decoration:none;text-decoration:none;}.css-778kay-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><style data-emotion="css zr39bh-MuiTypography-root-MuiLink-root">.css-zr39bh-MuiTypography-root-MuiLink-root{margin:0;color:#1976d2;-webkit-text-decoration:none;text-decoration:none;}.css-zr39bh-MuiTypography-root-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-zr39bh-MuiTypography-root-MuiLink-root" href="/docs"><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">Back to documentation index</p></a></div><hr style="margin:32px auto" class="jsx-1524775221"/><div><style data-emotion="css 1sra7t5-MuiTypography-root">.css-1sra7t5-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:300;font-size:3.75rem;line-height:1.2;letter-spacing:-0.00833em;}</style><h2 class="MuiTypography-root MuiTypography-h2 css-1sra7t5-MuiTypography-root">Magic imports</h2><ul><p>- <style data-emotion="css e784if-MuiTypography-root">.css-e784if-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;}</style><span class="MuiTypography-root MuiTypography-body2 css-e784if-MuiTypography-root">Use the <code>paths</code> property of tsconfig.common.json.</span></p><p>- <style data-emotion="css e784if-MuiTypography-root">.css-e784if-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;}</style><span class="MuiTypography-root MuiTypography-body2 css-e784if-MuiTypography-root">Add an alias in Next&#x27;s Webpack config</span></p><p>- <style data-emotion="css e784if-MuiTypography-root">.css-e784if-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;}</style><span class="MuiTypography-root MuiTypography-body2 css-e784if-MuiTypography-root">Add an alias in Jest moduleNameMapper config</span></p></ul><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root"><style data-emotion="css 778kay-MuiLink-root">.css-778kay-MuiLink-root{-webkit-text-decoration:none;text-decoration:none;}.css-778kay-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><style data-emotion="css zr39bh-MuiTypography-root-MuiLink-root">.css-zr39bh-MuiTypography-root-MuiLink-root{margin:0;color:#1976d2;-webkit-text-decoration:none;text-decoration:none;}.css-zr39bh-MuiTypography-root-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-zr39bh-MuiTypography-root-MuiLink-root" href="https://www.typescriptlang.org/docs/handbook/module-resolution.html">Relevant documentation</a></p><style data-emotion="css gepadz-MuiTypography-root">.css-gepadz-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:3rem;line-height:1.167;letter-spacing:0em;}</style><h3 class="MuiTypography-root MuiTypography-h3 css-gepadz-MuiTypography-root">Why 2-steps?</h3><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">Using TypeScript <code>paths</code> will only tell TypeScript where to find the code. However, it won&#x27;t replace your import path at build time.</p><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">So, you also need Webpack to actually replace <code>~/components/myComponent</code> to <code>../../../components/myComponent</code>.</p><style data-emotion="css 1sra7t5-MuiTypography-root">.css-1sra7t5-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:300;font-size:3.75rem;line-height:1.2;letter-spacing:-0.00833em;}</style><h2 class="MuiTypography-root MuiTypography-h2 css-1sra7t5-MuiTypography-root">Debugging Cypress build</h2><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">See <style data-emotion="css 778kay-MuiLink-root">.css-778kay-MuiLink-root{-webkit-text-decoration:none;text-decoration:none;}.css-778kay-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><style data-emotion="css zr39bh-MuiTypography-root-MuiLink-root">.css-zr39bh-MuiTypography-root-MuiLink-root{margin:0;color:#1976d2;-webkit-text-decoration:none;text-decoration:none;}.css-zr39bh-MuiTypography-root-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-zr39bh-MuiTypography-root-MuiLink-root" href="https://github.com/cypress-io/cypress-webpack-preprocessor">Cypress Webpack Preprocessor doc</a>, it describes a few environment variables useful to debug Cypress build.</p><style data-emotion="css 1sra7t5-MuiTypography-root">.css-1sra7t5-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:300;font-size:3.75rem;line-height:1.2;letter-spacing:-0.00833em;}</style><h2 class="MuiTypography-root MuiTypography-h2 css-1sra7t5-MuiTypography-root">Mock next packages</h2><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">Use a Webpack alias.</p><style data-emotion="css 1sra7t5-MuiTypography-root">.css-1sra7t5-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:300;font-size:3.75rem;line-height:1.2;letter-spacing:-0.00833em;}</style><h2 class="MuiTypography-root MuiTypography-h2 css-1sra7t5-MuiTypography-root">Connect to multiple graphql API in the frontend</h2><style data-emotion="css gepadz-MuiTypography-root">.css-gepadz-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:3rem;line-height:1.167;letter-spacing:0em;}</style><h3 class="MuiTypography-root MuiTypography-h3 css-gepadz-MuiTypography-root">Schema stitching?</h3><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">Handling connections to multiple graphQL APIs is the nightmare of the modern frontend developer.</p><ul><p>- <style data-emotion="css e784if-MuiTypography-root">.css-e784if-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;}</style><span class="MuiTypography-root MuiTypography-body2 css-e784if-MuiTypography-root">Your backend team may not be able to provide a unique API either. So you often need a way to do schema stitching client side.</span></p><p>- <style data-emotion="css e784if-MuiTypography-root">.css-e784if-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;}</style><span class="MuiTypography-root MuiTypography-body2 css-e784if-MuiTypography-root">Most documentations about schema stitching (client-side) assume that you own the schema (meaning you can get it locally), and that of course it&#x27;s written in JS. But real frontend developers, most often, connect to APIs they don&#x27;t own, probably written in a various set of languages...</span></p><p>- <style data-emotion="css e784if-MuiTypography-root">.css-e784if-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;}</style><span class="MuiTypography-root MuiTypography-body2 css-e784if-MuiTypography-root">You can do stitching of remote schemas, but documentation is rather terse.</span></p></ul><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">See <style data-emotion="css 778kay-MuiLink-root">.css-778kay-MuiLink-root{-webkit-text-decoration:none;text-decoration:none;}.css-778kay-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><style data-emotion="css zr39bh-MuiTypography-root-MuiLink-root">.css-zr39bh-MuiTypography-root-MuiLink-root{margin:0;color:#1976d2;-webkit-text-decoration:none;text-decoration:none;}.css-zr39bh-MuiTypography-root-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-zr39bh-MuiTypography-root-MuiLink-root" href="https://www.graphql-tools.com/docs/remote-schemas/">GraphQL tools documentation</a> for more infos on remote schemas and stitching.</p><style data-emotion="css gepadz-MuiTypography-root">.css-gepadz-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:3rem;line-height:1.167;letter-spacing:0em;}</style><h3 class="MuiTypography-root MuiTypography-h3 css-gepadz-MuiTypography-root">Multiple Apollo clients?</h3><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">No, you don&#x27;t do that. That messes up everything. EVERYTHING. Cache, optimistic UI, development tools... See the section just below for a cleaner, simpler pattern.</p><style data-emotion="css gepadz-MuiTypography-root">.css-gepadz-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:3rem;line-height:1.167;letter-spacing:0em;}</style><h3 class="MuiTypography-root MuiTypography-h3 css-gepadz-MuiTypography-root">Smart replacement of the HTTP link</h3><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">But there is one neat trick that &quot;Adepts of the schema stitch&quot; don&#x27;t want you to know!</p><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">It is described in this article from <style data-emotion="css 778kay-MuiLink-root">.css-778kay-MuiLink-root{-webkit-text-decoration:none;text-decoration:none;}.css-778kay-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><style data-emotion="css zr39bh-MuiTypography-root-MuiLink-root">.css-zr39bh-MuiTypography-root-MuiLink-root{margin:0;color:#1976d2;-webkit-text-decoration:none;text-decoration:none;}.css-zr39bh-MuiTypography-root-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-zr39bh-MuiTypography-root-MuiLink-root" href="https://www.loudnoises.us/next-js-two-apollo-clients-two-graphql-data-sources-the-easy-way/#comment-4707415813">Loud noises</a>. One user, @naveennazimudeen, proposed an extended version <a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-zr39bh-MuiTypography-root-MuiLink-root" href="https://www.loudnoises.us/next-js-two-apollo-clients-two-graphql-data-sources-the-easy-way/#comment-4707415813">in the comments of said article</a> to handle N services.</p><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">The idea is to use <style data-emotion="css 778kay-MuiLink-root">.css-778kay-MuiLink-root{-webkit-text-decoration:none;text-decoration:none;}.css-778kay-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><style data-emotion="css zr39bh-MuiTypography-root-MuiLink-root">.css-zr39bh-MuiTypography-root-MuiLink-root{margin:0;color:#1976d2;-webkit-text-decoration:none;text-decoration:none;}.css-zr39bh-MuiTypography-root-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-zr39bh-MuiTypography-root-MuiLink-root" href="https://www.apollographql.com/docs/link/composition/#directional-composition">directionnal composition</a> from Apollo Link. That&#x27;s a frightening term to say that you can replace a link depending on the context. Let&#x27;s see the code:</p><pre><code class="language-js">// Using Apollo v2, but it should extend to newer versions
import { split } from &quot;apollo-link&quot;
// Compute the HTTP link depending on the context
const getHttpLink = (operation) =&gt; {
  const service = operation.getContext().service;
  let uri= &quot;&quot;;
  if (!service || service === &quot;main&quot;) uri = &quot;http://localhost:3000/api/graphql&quot;;
  if (service === &quot;user&quot;) uri = &quot;http://my-user-service.whatever&quot;;
  if (service === &quot;vulcan&quot;) uri = &quot;http://localhost:3001/graphql&quot;
  const link = httpLink(uri);
  return link.request(operation);
};

// Trick to be able to load any number of links using split, by calling a function
const multiUriHttpLink = split(
    () =&gt; true, // force to call the first (and only) branch of the split
    operation =&gt; getHttpLink(operation, ctx) // by using a function, we allow to split between any number of links
  );

// and then in your ApolloClient construction:
...
link: from([errorLink, multiUriHttpLink]),
...
</code></pre><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">And then you can swap the service like so:</p><pre><code class="language-js">// usage
const { data, loading, error } = useQuery(MY_QUERY, {
  context: { service: &quot;service1&quot; },
});
</code></pre><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root"><strong>Main limitation is that you can call services only one by one.</strong> This pattern is not the recommended way to call multiple APIs, it has clear limitations. But it does the trick , especially if you need to quickly connect to many 3rd party libraries in isolated parts of your app.</p><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">Since we use the same client and only change a link, the Apollo cache is shared between services. DevTools should still work with this approach.</p><style data-emotion="css 1sra7t5-MuiTypography-root">.css-1sra7t5-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:300;font-size:3.75rem;line-height:1.2;letter-spacing:-0.00833em;}</style><h2 class="MuiTypography-root MuiTypography-h2 css-1sra7t5-MuiTypography-root">Test server-only code</h2><style data-emotion="css gepadz-MuiTypography-root">.css-gepadz-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:3rem;line-height:1.167;letter-spacing:0em;}</style><h3 class="MuiTypography-root MuiTypography-h3 css-gepadz-MuiTypography-root">Approach 1: change the <code>testEnvironment</code> on the fly</h3><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root"><code>jsdom</code> (=client) is the default <code>testEnvironment</code> option for Jest. When testing your app server-specific code,
you may want to use the <code>node</code> environment.</p><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">You can do so for a specific test file by adding this at the top:</p><pre><code class="language-js">/**
 * // @see https://jestjs.io/docs/en/next/configuration#testenvironment-string
 * @jest-environment node
 */
</code></pre><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">Pro: no need to change the config
Con: can become tedious, not easy to see server-only tests at first glances</p><style data-emotion="css gepadz-MuiTypography-root">.css-gepadz-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:3rem;line-height:1.167;letter-spacing:0em;}</style><h3 class="MuiTypography-root MuiTypography-h3 css-gepadz-MuiTypography-root">Approach 2: use 2 separate configs</h3><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">Define <code>jest.config.server.ts</code> like this for example:</p><pre><code class="language-js">const baseConfig = require(&quot;./jest.config&quot;);
module.exports = {
  ...baseConfig,
  testEnvironment: &quot;node&quot;,
  testMatch: [
    (testMatch: [
      &quot;**/__tests__/**/*.server.[jt]s?(x)&quot;,
      &quot;**/?(*.)+(spec|test).server.[tj]s?(x)&quot;
    ]),
  ],
};
</code></pre><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">Only tests named <code>foobar.test.server.js</code> (or ts, etc.) will be matched.</p><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">Pro: clean, can handle files per folder or per name using a Regex.
Cons: using 2 configs =&gt; using 2 commands, you need to name your server only test specifically,
or to isolate them in a specific folder,
more difficult to compute coverage, more configuration</p><style data-emotion="css gepadz-MuiTypography-root">.css-gepadz-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:3rem;line-height:1.167;letter-spacing:0em;}</style><h3 class="MuiTypography-root MuiTypography-h3 css-gepadz-MuiTypography-root">Approach 3: use one config with the <code>projects</code> options</h3><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">With the <code>projects</code> options, you can use 2 different Jest config depending on the file name or location.
So you can use one config for server tests and one for client tests.</p><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">Pro: based on a core feature of Jest, will compute coverage correctly
Cons: you need to name your server specifically or to isolate them in a specific folder</p></div><hr style="margin:32px auto" class="jsx-1524775221"/><div style="max-width:1000px"><style data-emotion="css 778kay-MuiLink-root">.css-778kay-MuiLink-root{-webkit-text-decoration:none;text-decoration:none;}.css-778kay-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><style data-emotion="css zr39bh-MuiTypography-root-MuiLink-root">.css-zr39bh-MuiTypography-root-MuiLink-root{margin:0;color:#1976d2;-webkit-text-decoration:none;text-decoration:none;}.css-zr39bh-MuiTypography-root-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-zr39bh-MuiTypography-root-MuiLink-root" href="/docs"><style data-emotion="css ahj2mt-MuiTypography-root">.css-ahj2mt-MuiTypography-root{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root">Back to documentation index</p></a></div></div></main><footer class="jsx-376217870"><nav class="jsx-376217870"><ul class="jsx-376217870"><li class="jsx-376217870"><a class="jsx-376217870" href="/">Home</a></li><li class="jsx-376217870"><a class="jsx-376217870" href="/login">Login</a></li></ul></nav></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"initialI18nStore":{"en":{"common":{"__Debug message":"Hi, I am in English 🇬🇧"}}},"initialLanguage":"en","i18nServerInstance":null,"pageProps":{"pages":[],"filePath":"recipes","source":{"compiledSource":"\"use strict\";\n\nvar _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i \u003c arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i \u003c sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i \u003c sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar layoutProps = {};\nvar MDXLayout = \"wrapper\";\n\nfunction MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h2\", null, \"Magic imports\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Use the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"paths\"), \" property of tsconfig.common.json.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Add an alias in Next's Webpack config\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Add an alias in Jest moduleNameMapper config\")), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.typescriptlang.org/docs/handbook/module-resolution.html\"\n  }, \"Relevant documentation\")), mdx(\"h3\", null, \"Why 2-steps?\"), mdx(\"p\", null, \"Using TypeScript \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"paths\"), \" will only tell TypeScript where to find the code. However, it won't replace your import path at build time.\"), mdx(\"p\", null, \"So, you also need Webpack to actually replace \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"~/components/myComponent\"), \" to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"../../../components/myComponent\"), \".\"), mdx(\"h2\", null, \"Debugging Cypress build\"), mdx(\"p\", null, \"See \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/cypress-io/cypress-webpack-preprocessor\"\n  }, \"Cypress Webpack Preprocessor doc\"), \", it describes a few environment variables useful to debug Cypress build.\"), mdx(\"h2\", null, \"Mock next packages\"), mdx(\"p\", null, \"Use a Webpack alias.\"), mdx(\"h2\", null, \"Connect to multiple graphql API in the frontend\"), mdx(\"h3\", null, \"Schema stitching?\"), mdx(\"p\", null, \"Handling connections to multiple graphQL APIs is the nightmare of the modern frontend developer.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Your backend team may not be able to provide a unique API either. So you often need a way to do schema stitching client side.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Most documentations about schema stitching (client-side) assume that you own the schema (meaning you can get it locally), and that of course it's written in JS. But real frontend developers, most often, connect to APIs they don't own, probably written in a various set of languages...\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"You can do stitching of remote schemas, but documentation is rather terse.\")), mdx(\"p\", null, \"See \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.graphql-tools.com/docs/remote-schemas/\"\n  }, \"GraphQL tools documentation\"), \" for more infos on remote schemas and stitching.\"), mdx(\"h3\", null, \"Multiple Apollo clients?\"), mdx(\"p\", null, \"No, you don't do that. That messes up everything. EVERYTHING. Cache, optimistic UI, development tools... See the section just below for a cleaner, simpler pattern.\"), mdx(\"h3\", null, \"Smart replacement of the HTTP link\"), mdx(\"p\", null, \"But there is one neat trick that \\\"Adepts of the schema stitch\\\" don't want you to know!\"), mdx(\"p\", null, \"It is described in this article from \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.loudnoises.us/next-js-two-apollo-clients-two-graphql-data-sources-the-easy-way/#comment-4707415813\"\n  }, \"Loud noises\"), \". One user, @naveennazimudeen, proposed an extended version \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.loudnoises.us/next-js-two-apollo-clients-two-graphql-data-sources-the-easy-way/#comment-4707415813\"\n  }, \"in the comments of said article\"), \" to handle N services.\"), mdx(\"p\", null, \"The idea is to use \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.apollographql.com/docs/link/composition/#directional-composition\"\n  }, \"directionnal composition\"), \" from Apollo Link. That's a frightening term to say that you can replace a link depending on the context. Let's see the code:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"// Using Apollo v2, but it should extend to newer versions\\nimport { split } from \\\"apollo-link\\\"\\n// Compute the HTTP link depending on the context\\nconst getHttpLink = (operation) =\u003e {\\n  const service = operation.getContext().service;\\n  let uri= \\\"\\\";\\n  if (!service || service === \\\"main\\\") uri = \\\"http://localhost:3000/api/graphql\\\";\\n  if (service === \\\"user\\\") uri = \\\"http://my-user-service.whatever\\\";\\n  if (service === \\\"vulcan\\\") uri = \\\"http://localhost:3001/graphql\\\"\\n  const link = httpLink(uri);\\n  return link.request(operation);\\n};\\n\\n// Trick to be able to load any number of links using split, by calling a function\\nconst multiUriHttpLink = split(\\n    () =\u003e true, // force to call the first (and only) branch of the split\\n    operation =\u003e getHttpLink(operation, ctx) // by using a function, we allow to split between any number of links\\n  );\\n\\n// and then in your ApolloClient construction:\\n...\\nlink: from([errorLink, multiUriHttpLink]),\\n...\\n\")), mdx(\"p\", null, \"And then you can swap the service like so:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"// usage\\nconst { data, loading, error } = useQuery(MY_QUERY, {\\n  context: { service: \\\"service1\\\" },\\n});\\n\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Main limitation is that you can call services only one by one.\"), \" This pattern is not the recommended way to call multiple APIs, it has clear limitations. But it does the trick , especially if you need to quickly connect to many 3rd party libraries in isolated parts of your app.\"), mdx(\"p\", null, \"Since we use the same client and only change a link, the Apollo cache is shared between services. DevTools should still work with this approach.\"), mdx(\"h2\", null, \"Test server-only code\"), mdx(\"h3\", null, \"Approach 1: change the \", mdx(\"inlineCode\", {\n    parentName: \"h3\"\n  }, \"testEnvironment\"), \" on the fly\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"jsdom\"), \" (=client) is the default \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"testEnvironment\"), \" option for Jest. When testing your app server-specific code,\\nyou may want to use the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"node\"), \" environment.\"), mdx(\"p\", null, \"You can do so for a specific test file by adding this at the top:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"/**\\n * // @see https://jestjs.io/docs/en/next/configuration#testenvironment-string\\n * @jest-environment node\\n */\\n\")), mdx(\"p\", null, \"Pro: no need to change the config\\nCon: can become tedious, not easy to see server-only tests at first glances\"), mdx(\"h3\", null, \"Approach 2: use 2 separate configs\"), mdx(\"p\", null, \"Define \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"jest.config.server.ts\"), \" like this for example:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"const baseConfig = require(\\\"./jest.config\\\");\\nmodule.exports = {\\n  ...baseConfig,\\n  testEnvironment: \\\"node\\\",\\n  testMatch: [\\n    (testMatch: [\\n      \\\"**/__tests__/**/*.server.[jt]s?(x)\\\",\\n      \\\"**/?(*.)+(spec|test).server.[tj]s?(x)\\\"\\n    ]),\\n  ],\\n};\\n\")), mdx(\"p\", null, \"Only tests named \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"foobar.test.server.js\"), \" (or ts, etc.) will be matched.\"), mdx(\"p\", null, \"Pro: clean, can handle files per folder or per name using a Regex.\\nCons: using 2 configs =\u003e using 2 commands, you need to name your server only test specifically,\\nor to isolate them in a specific folder,\\nmore difficult to compute coverage, more configuration\"), mdx(\"h3\", null, \"Approach 3: use one config with the \", mdx(\"inlineCode\", {\n    parentName: \"h3\"\n  }, \"projects\"), \" options\"), mdx(\"p\", null, \"With the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"projects\"), \" options, you can use 2 different Jest config depending on the file name or location.\\nSo you can use one config for server tests and one for client tests.\"), mdx(\"p\", null, \"Pro: based on a core feature of Jest, will compute coverage correctly\\nCons: you need to name your server specifically or to isolate them in a specific folder\"));\n}\n\n;\nMDXContent.isMDXComponent = true;","renderedOutput":"\u003cstyle data-emotion=\"css 1sra7t5-MuiTypography-root\"\u003e.css-1sra7t5-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:300;font-size:3.75rem;line-height:1.2;letter-spacing:-0.00833em;}\u003c/style\u003e\u003ch2 class=\"MuiTypography-root MuiTypography-h2 css-1sra7t5-MuiTypography-root\"\u003eMagic imports\u003c/h2\u003e\u003cul\u003e\u003cp\u003e- \u003cstyle data-emotion=\"css e784if-MuiTypography-root\"\u003e.css-e784if-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;}\u003c/style\u003e\u003cspan class=\"MuiTypography-root MuiTypography-body2 css-e784if-MuiTypography-root\"\u003eUse the \u003ccode\u003epaths\u003c/code\u003e property of tsconfig.common.json.\u003c/span\u003e\u003c/p\u003e\u003cp\u003e- \u003cstyle data-emotion=\"css e784if-MuiTypography-root\"\u003e.css-e784if-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;}\u003c/style\u003e\u003cspan class=\"MuiTypography-root MuiTypography-body2 css-e784if-MuiTypography-root\"\u003eAdd an alias in Next\u0026#x27;s Webpack config\u003c/span\u003e\u003c/p\u003e\u003cp\u003e- \u003cstyle data-emotion=\"css e784if-MuiTypography-root\"\u003e.css-e784if-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;}\u003c/style\u003e\u003cspan class=\"MuiTypography-root MuiTypography-body2 css-e784if-MuiTypography-root\"\u003eAdd an alias in Jest moduleNameMapper config\u003c/span\u003e\u003c/p\u003e\u003c/ul\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003e\u003cstyle data-emotion=\"css 778kay-MuiLink-root\"\u003e.css-778kay-MuiLink-root{-webkit-text-decoration:none;text-decoration:none;}.css-778kay-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}\u003c/style\u003e\u003cstyle data-emotion=\"css zr39bh-MuiTypography-root-MuiLink-root\"\u003e.css-zr39bh-MuiTypography-root-MuiLink-root{margin:0;color:#1976d2;-webkit-text-decoration:none;text-decoration:none;}.css-zr39bh-MuiTypography-root-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}\u003c/style\u003e\u003ca class=\"MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-zr39bh-MuiTypography-root-MuiLink-root\" href=\"https://www.typescriptlang.org/docs/handbook/module-resolution.html\"\u003eRelevant documentation\u003c/a\u003e\u003c/p\u003e\u003cstyle data-emotion=\"css gepadz-MuiTypography-root\"\u003e.css-gepadz-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:3rem;line-height:1.167;letter-spacing:0em;}\u003c/style\u003e\u003ch3 class=\"MuiTypography-root MuiTypography-h3 css-gepadz-MuiTypography-root\"\u003eWhy 2-steps?\u003c/h3\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003eUsing TypeScript \u003ccode\u003epaths\u003c/code\u003e will only tell TypeScript where to find the code. However, it won\u0026#x27;t replace your import path at build time.\u003c/p\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003eSo, you also need Webpack to actually replace \u003ccode\u003e~/components/myComponent\u003c/code\u003e to \u003ccode\u003e../../../components/myComponent\u003c/code\u003e.\u003c/p\u003e\u003cstyle data-emotion=\"css 1sra7t5-MuiTypography-root\"\u003e.css-1sra7t5-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:300;font-size:3.75rem;line-height:1.2;letter-spacing:-0.00833em;}\u003c/style\u003e\u003ch2 class=\"MuiTypography-root MuiTypography-h2 css-1sra7t5-MuiTypography-root\"\u003eDebugging Cypress build\u003c/h2\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003eSee \u003cstyle data-emotion=\"css 778kay-MuiLink-root\"\u003e.css-778kay-MuiLink-root{-webkit-text-decoration:none;text-decoration:none;}.css-778kay-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}\u003c/style\u003e\u003cstyle data-emotion=\"css zr39bh-MuiTypography-root-MuiLink-root\"\u003e.css-zr39bh-MuiTypography-root-MuiLink-root{margin:0;color:#1976d2;-webkit-text-decoration:none;text-decoration:none;}.css-zr39bh-MuiTypography-root-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}\u003c/style\u003e\u003ca class=\"MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-zr39bh-MuiTypography-root-MuiLink-root\" href=\"https://github.com/cypress-io/cypress-webpack-preprocessor\"\u003eCypress Webpack Preprocessor doc\u003c/a\u003e, it describes a few environment variables useful to debug Cypress build.\u003c/p\u003e\u003cstyle data-emotion=\"css 1sra7t5-MuiTypography-root\"\u003e.css-1sra7t5-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:300;font-size:3.75rem;line-height:1.2;letter-spacing:-0.00833em;}\u003c/style\u003e\u003ch2 class=\"MuiTypography-root MuiTypography-h2 css-1sra7t5-MuiTypography-root\"\u003eMock next packages\u003c/h2\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003eUse a Webpack alias.\u003c/p\u003e\u003cstyle data-emotion=\"css 1sra7t5-MuiTypography-root\"\u003e.css-1sra7t5-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:300;font-size:3.75rem;line-height:1.2;letter-spacing:-0.00833em;}\u003c/style\u003e\u003ch2 class=\"MuiTypography-root MuiTypography-h2 css-1sra7t5-MuiTypography-root\"\u003eConnect to multiple graphql API in the frontend\u003c/h2\u003e\u003cstyle data-emotion=\"css gepadz-MuiTypography-root\"\u003e.css-gepadz-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:3rem;line-height:1.167;letter-spacing:0em;}\u003c/style\u003e\u003ch3 class=\"MuiTypography-root MuiTypography-h3 css-gepadz-MuiTypography-root\"\u003eSchema stitching?\u003c/h3\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003eHandling connections to multiple graphQL APIs is the nightmare of the modern frontend developer.\u003c/p\u003e\u003cul\u003e\u003cp\u003e- \u003cstyle data-emotion=\"css e784if-MuiTypography-root\"\u003e.css-e784if-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;}\u003c/style\u003e\u003cspan class=\"MuiTypography-root MuiTypography-body2 css-e784if-MuiTypography-root\"\u003eYour backend team may not be able to provide a unique API either. So you often need a way to do schema stitching client side.\u003c/span\u003e\u003c/p\u003e\u003cp\u003e- \u003cstyle data-emotion=\"css e784if-MuiTypography-root\"\u003e.css-e784if-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;}\u003c/style\u003e\u003cspan class=\"MuiTypography-root MuiTypography-body2 css-e784if-MuiTypography-root\"\u003eMost documentations about schema stitching (client-side) assume that you own the schema (meaning you can get it locally), and that of course it\u0026#x27;s written in JS. But real frontend developers, most often, connect to APIs they don\u0026#x27;t own, probably written in a various set of languages...\u003c/span\u003e\u003c/p\u003e\u003cp\u003e- \u003cstyle data-emotion=\"css e784if-MuiTypography-root\"\u003e.css-e784if-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;}\u003c/style\u003e\u003cspan class=\"MuiTypography-root MuiTypography-body2 css-e784if-MuiTypography-root\"\u003eYou can do stitching of remote schemas, but documentation is rather terse.\u003c/span\u003e\u003c/p\u003e\u003c/ul\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003eSee \u003cstyle data-emotion=\"css 778kay-MuiLink-root\"\u003e.css-778kay-MuiLink-root{-webkit-text-decoration:none;text-decoration:none;}.css-778kay-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}\u003c/style\u003e\u003cstyle data-emotion=\"css zr39bh-MuiTypography-root-MuiLink-root\"\u003e.css-zr39bh-MuiTypography-root-MuiLink-root{margin:0;color:#1976d2;-webkit-text-decoration:none;text-decoration:none;}.css-zr39bh-MuiTypography-root-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}\u003c/style\u003e\u003ca class=\"MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-zr39bh-MuiTypography-root-MuiLink-root\" href=\"https://www.graphql-tools.com/docs/remote-schemas/\"\u003eGraphQL tools documentation\u003c/a\u003e for more infos on remote schemas and stitching.\u003c/p\u003e\u003cstyle data-emotion=\"css gepadz-MuiTypography-root\"\u003e.css-gepadz-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:3rem;line-height:1.167;letter-spacing:0em;}\u003c/style\u003e\u003ch3 class=\"MuiTypography-root MuiTypography-h3 css-gepadz-MuiTypography-root\"\u003eMultiple Apollo clients?\u003c/h3\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003eNo, you don\u0026#x27;t do that. That messes up everything. EVERYTHING. Cache, optimistic UI, development tools... See the section just below for a cleaner, simpler pattern.\u003c/p\u003e\u003cstyle data-emotion=\"css gepadz-MuiTypography-root\"\u003e.css-gepadz-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:3rem;line-height:1.167;letter-spacing:0em;}\u003c/style\u003e\u003ch3 class=\"MuiTypography-root MuiTypography-h3 css-gepadz-MuiTypography-root\"\u003eSmart replacement of the HTTP link\u003c/h3\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003eBut there is one neat trick that \u0026quot;Adepts of the schema stitch\u0026quot; don\u0026#x27;t want you to know!\u003c/p\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003eIt is described in this article from \u003cstyle data-emotion=\"css 778kay-MuiLink-root\"\u003e.css-778kay-MuiLink-root{-webkit-text-decoration:none;text-decoration:none;}.css-778kay-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}\u003c/style\u003e\u003cstyle data-emotion=\"css zr39bh-MuiTypography-root-MuiLink-root\"\u003e.css-zr39bh-MuiTypography-root-MuiLink-root{margin:0;color:#1976d2;-webkit-text-decoration:none;text-decoration:none;}.css-zr39bh-MuiTypography-root-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}\u003c/style\u003e\u003ca class=\"MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-zr39bh-MuiTypography-root-MuiLink-root\" href=\"https://www.loudnoises.us/next-js-two-apollo-clients-two-graphql-data-sources-the-easy-way/#comment-4707415813\"\u003eLoud noises\u003c/a\u003e. One user, @naveennazimudeen, proposed an extended version \u003ca class=\"MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-zr39bh-MuiTypography-root-MuiLink-root\" href=\"https://www.loudnoises.us/next-js-two-apollo-clients-two-graphql-data-sources-the-easy-way/#comment-4707415813\"\u003ein the comments of said article\u003c/a\u003e to handle N services.\u003c/p\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003eThe idea is to use \u003cstyle data-emotion=\"css 778kay-MuiLink-root\"\u003e.css-778kay-MuiLink-root{-webkit-text-decoration:none;text-decoration:none;}.css-778kay-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}\u003c/style\u003e\u003cstyle data-emotion=\"css zr39bh-MuiTypography-root-MuiLink-root\"\u003e.css-zr39bh-MuiTypography-root-MuiLink-root{margin:0;color:#1976d2;-webkit-text-decoration:none;text-decoration:none;}.css-zr39bh-MuiTypography-root-MuiLink-root:hover{-webkit-text-decoration:underline;text-decoration:underline;}\u003c/style\u003e\u003ca class=\"MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-zr39bh-MuiTypography-root-MuiLink-root\" href=\"https://www.apollographql.com/docs/link/composition/#directional-composition\"\u003edirectionnal composition\u003c/a\u003e from Apollo Link. That\u0026#x27;s a frightening term to say that you can replace a link depending on the context. Let\u0026#x27;s see the code:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-js\"\u003e// Using Apollo v2, but it should extend to newer versions\nimport { split } from \u0026quot;apollo-link\u0026quot;\n// Compute the HTTP link depending on the context\nconst getHttpLink = (operation) =\u0026gt; {\n  const service = operation.getContext().service;\n  let uri= \u0026quot;\u0026quot;;\n  if (!service || service === \u0026quot;main\u0026quot;) uri = \u0026quot;http://localhost:3000/api/graphql\u0026quot;;\n  if (service === \u0026quot;user\u0026quot;) uri = \u0026quot;http://my-user-service.whatever\u0026quot;;\n  if (service === \u0026quot;vulcan\u0026quot;) uri = \u0026quot;http://localhost:3001/graphql\u0026quot;\n  const link = httpLink(uri);\n  return link.request(operation);\n};\n\n// Trick to be able to load any number of links using split, by calling a function\nconst multiUriHttpLink = split(\n    () =\u0026gt; true, // force to call the first (and only) branch of the split\n    operation =\u0026gt; getHttpLink(operation, ctx) // by using a function, we allow to split between any number of links\n  );\n\n// and then in your ApolloClient construction:\n...\nlink: from([errorLink, multiUriHttpLink]),\n...\n\u003c/code\u003e\u003c/pre\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003eAnd then you can swap the service like so:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-js\"\u003e// usage\nconst { data, loading, error } = useQuery(MY_QUERY, {\n  context: { service: \u0026quot;service1\u0026quot; },\n});\n\u003c/code\u003e\u003c/pre\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003e\u003cstrong\u003eMain limitation is that you can call services only one by one.\u003c/strong\u003e This pattern is not the recommended way to call multiple APIs, it has clear limitations. But it does the trick , especially if you need to quickly connect to many 3rd party libraries in isolated parts of your app.\u003c/p\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003eSince we use the same client and only change a link, the Apollo cache is shared between services. DevTools should still work with this approach.\u003c/p\u003e\u003cstyle data-emotion=\"css 1sra7t5-MuiTypography-root\"\u003e.css-1sra7t5-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:300;font-size:3.75rem;line-height:1.2;letter-spacing:-0.00833em;}\u003c/style\u003e\u003ch2 class=\"MuiTypography-root MuiTypography-h2 css-1sra7t5-MuiTypography-root\"\u003eTest server-only code\u003c/h2\u003e\u003cstyle data-emotion=\"css gepadz-MuiTypography-root\"\u003e.css-gepadz-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:3rem;line-height:1.167;letter-spacing:0em;}\u003c/style\u003e\u003ch3 class=\"MuiTypography-root MuiTypography-h3 css-gepadz-MuiTypography-root\"\u003eApproach 1: change the \u003ccode\u003etestEnvironment\u003c/code\u003e on the fly\u003c/h3\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003e\u003ccode\u003ejsdom\u003c/code\u003e (=client) is the default \u003ccode\u003etestEnvironment\u003c/code\u003e option for Jest. When testing your app server-specific code,\nyou may want to use the \u003ccode\u003enode\u003c/code\u003e environment.\u003c/p\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003eYou can do so for a specific test file by adding this at the top:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-js\"\u003e/**\n * // @see https://jestjs.io/docs/en/next/configuration#testenvironment-string\n * @jest-environment node\n */\n\u003c/code\u003e\u003c/pre\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003ePro: no need to change the config\nCon: can become tedious, not easy to see server-only tests at first glances\u003c/p\u003e\u003cstyle data-emotion=\"css gepadz-MuiTypography-root\"\u003e.css-gepadz-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:3rem;line-height:1.167;letter-spacing:0em;}\u003c/style\u003e\u003ch3 class=\"MuiTypography-root MuiTypography-h3 css-gepadz-MuiTypography-root\"\u003eApproach 2: use 2 separate configs\u003c/h3\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003eDefine \u003ccode\u003ejest.config.server.ts\u003c/code\u003e like this for example:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-js\"\u003econst baseConfig = require(\u0026quot;./jest.config\u0026quot;);\nmodule.exports = {\n  ...baseConfig,\n  testEnvironment: \u0026quot;node\u0026quot;,\n  testMatch: [\n    (testMatch: [\n      \u0026quot;**/__tests__/**/*.server.[jt]s?(x)\u0026quot;,\n      \u0026quot;**/?(*.)+(spec|test).server.[tj]s?(x)\u0026quot;\n    ]),\n  ],\n};\n\u003c/code\u003e\u003c/pre\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003eOnly tests named \u003ccode\u003efoobar.test.server.js\u003c/code\u003e (or ts, etc.) will be matched.\u003c/p\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003ePro: clean, can handle files per folder or per name using a Regex.\nCons: using 2 configs =\u0026gt; using 2 commands, you need to name your server only test specifically,\nor to isolate them in a specific folder,\nmore difficult to compute coverage, more configuration\u003c/p\u003e\u003cstyle data-emotion=\"css gepadz-MuiTypography-root\"\u003e.css-gepadz-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:3rem;line-height:1.167;letter-spacing:0em;}\u003c/style\u003e\u003ch3 class=\"MuiTypography-root MuiTypography-h3 css-gepadz-MuiTypography-root\"\u003eApproach 3: use one config with the \u003ccode\u003eprojects\u003c/code\u003e options\u003c/h3\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003eWith the \u003ccode\u003eprojects\u003c/code\u003e options, you can use 2 different Jest config depending on the file name or location.\nSo you can use one config for server tests and one for client tests.\u003c/p\u003e\u003cstyle data-emotion=\"css ahj2mt-MuiTypography-root\"\u003e.css-ahj2mt-MuiTypography-root{margin:0;font-family:\"Roboto\",\"Helvetica\",\"Arial\",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}\u003c/style\u003e\u003cp class=\"MuiTypography-root MuiTypography-body1 css-ahj2mt-MuiTypography-root\"\u003ePro: based on a core feature of Jest, will compute coverage correctly\nCons: you need to name your server specifically or to isolate them in a specific folder\u003c/p\u003e","scope":{}}},"__N_SSG":true},"page":"/docs/[[...filePath]]","query":{"filePath":["recipes"]},"buildId":"yDKR32CIc52uDJyFw4Fpv","runtimeConfig":{"pkgInfo":{"version":"0.4.0"}},"isFallback":false,"gsp":true,"appGip":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-b66f64276ff547e96d45.js"></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/framework.15878d4e523f86636251.js" async=""></script><script src="/_next/static/chunks/49d37b1fe5b22506c9fa44358877aa1ad4760387.84b9a2250f3507cbc246.js" async=""></script><script src="/_next/static/chunks/main-0c1b2fbe949ce7ed0b37.js" async=""></script><script src="/_next/static/chunks/6814153d.55e79d0ace6a369535d5.js" async=""></script><script src="/_next/static/chunks/abdd1237.851fcaa2eb374e04eb6e.js" async=""></script><script src="/_next/static/chunks/2852872c.1e535e2a60c8b1bb652c.js" async=""></script><script src="/_next/static/chunks/a7b3c51d.52db8c35c087bd5201c4.js" async=""></script><script src="/_next/static/chunks/6bf3b88e.63754aeaeb9ea39b4450.js" async=""></script><script src="/_next/static/chunks/d8b556227082b089fba546fc49732c1c26dde9e8.3baab1ffc7e421b8ce40.js" async=""></script><script src="/_next/static/chunks/cacb2f4be546d82ccacbeceb90144647cfaf61b3.5e95e488b17f7061269a.js" async=""></script><script src="/_next/static/chunks/dc94815230cec2e3dc385c60b5c9915f62add97b.695396e86e0ec8897ecf.js" async=""></script><script src="/_next/static/chunks/a30cd3318b9b886b5d858ad51b134bd993cb5816.d27260bb935159bd6a45.js" async=""></script><script src="/_next/static/chunks/d4e47d1519710928b34951a0ea9d9cd193d92d49.9971bad6776f2ae33b1d.js" async=""></script><script src="/_next/static/chunks/3a70e6ca8bb90afb418f91901a1a2d79eca87d11.653c5ba70ff602495b97.js" async=""></script><script src="/_next/static/chunks/a0ff704ef108d8660daf8e32b79639862454ff27.2699fef4fca937f989ce.js" async=""></script><script src="/_next/static/chunks/b202358fbad7102d8f59ff97683d6692f5162b5a.ff60acf86fb391457c31.js" async=""></script><script src="/_next/static/chunks/065cc5f8365af490fbc175069f90cda4b12ce284.84c794ca58b26180faf5.js" async=""></script><script src="/_next/static/chunks/9e2eadce9af178671d966780d5efb249d032d4cb.d95f3055d0bd9b97b719.js" async=""></script><script src="/_next/static/chunks/73ac6b829710f5f1d659c5f8c66d8fd8a56cf37b.ba3cf88997dfb8224aaf.js" async=""></script><script src="/_next/static/chunks/pages/_app-b8fa6429bc2f3fc3e6f0.js" async=""></script><script src="/_next/static/chunks/020c44199048e84d10f9273012ae0db0d8fa4bac.993dcc6fba2c95c40340.js" async=""></script><script src="/_next/static/chunks/e06310d82fadbc2be302e5a8f1a04fa265a72c52.302fd6ae58f1dc2acb02.js" async=""></script><script src="/_next/static/chunks/44092f8551b68c748985c7de7a4b45e7cfc73eb0.5eb7c3e485d7c226cd16.js" async=""></script><script src="/_next/static/chunks/pages/docs/%5B%5B...filePath%5D%5D-ffb2f77215366165b9d3.js" async=""></script><script src="/_next/static/yDKR32CIc52uDJyFw4Fpv/_buildManifest.js" async=""></script><script src="/_next/static/yDKR32CIc52uDJyFw4Fpv/_ssgManifest.js" async=""></script></body></html>